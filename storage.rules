rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {

    // --- KULLANICI PROFİL FOTOĞRAFLARI ---
    // Kullanıcılar sadece kendi klasörlerine (kullanıcı ID'leri ile adlandırılmış) dosya yükleyebilir.
    // Herkes profil fotoğraflarını okuyabilir (genellikle herkese açık olurlar).
    // Kullanıcılar sadece kendi profil fotoğraflarını silebilir.
    match /user_avatars/{userId}/{fileName} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.uid == userId;
      allow delete: if request.auth != null && request.auth.uid == userId;
    }

    // --- GENEL İÇERİK DOSYALARI (ÖRNEK) ---
    // 'public_content' gibi bir klasördeki dosyaların herkes tarafından okunmasına izin verilebilir.
    // Yazma işlemi ise sadece yöneticilere (admin) özel kılınabilir.
    // match /public_content/{allPaths=**} {
    //   allow read: if true;
    //   allow write: if request.auth != null && request.auth.token.admin == true;
    // }

    // Yukarıda belirtilenler dışındaki tüm erişimleri engelle.
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
